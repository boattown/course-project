{"ast":null,"code":"import { send, assign } from \"xstate\";\nimport { nluRequest } from \"./index\";\n\nfunction say(text) {\n  return send(function (_context) {\n    return {\n      type: \"SPEAK\",\n      value: text\n    };\n  });\n}\n\nfunction listen() {\n  return send('LISTEN');\n}\n\nfunction rasaParse(currentState, target1, intent1, target2, intent2) {\n  return {\n    invoke: {\n      id: 'rasa',\n      src: function src(context, event) {\n        return nluRequest(context.recResult);\n      },\n      onDone: [{\n        target: \"#root.dm.game.\".concat(target1),\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] === intent1;\n        }\n      }, {\n        target: \"#root.dm.game.\".concat(target2),\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] === intent2;\n        }\n      }, {\n        target: \"#root.dm.game.\".concat(currentState, \".repeat1\"),\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" && event.data.intent[\"name\"] !== \"repeat\";\n        }\n      }, {\n        target: \"#root.dm.game.hist\",\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] === \"repeat\";\n        }\n      }, {\n        target: \"#root.dm.help\",\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] === \"help\";\n        }\n      }, {\n        target: \"#root.dm.quit\",\n        cond: function cond(context, event) {\n          return event.data.intent[\"name\"] === \"quit\";\n        }\n      }],\n      onError: {\n        target: '#root.dm.error'\n      }\n    }\n  };\n}\n\nfunction repeatQuestion(currentState, question, target1, intent1, target2, intent2) {\n  return {\n    initial: \"prompt\",\n    on: {\n      RECOGNISED: {\n        target: \".rasa\"\n      }\n    },\n    states: {\n      prompt: {\n        entry: say(question),\n        on: {\n          ENDSPEECH: \"ask\"\n        }\n      },\n      ask: {\n        entry: listen()\n      },\n      rasa: {\n        invoke: {\n          id: 'rasa',\n          src: function src(context, event) {\n            return nluRequest(context.recResult);\n          },\n          onDone: [{\n            target: \"#root.dm.game.\".concat(target1),\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === intent1;\n            }\n          }, {\n            target: \"#root.dm.game.\".concat(target2),\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === intent2;\n            }\n          }, {\n            target: \"#root.dm.game.\".concat(currentState, \".repeat2\"),\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\";\n            }\n          }, {\n            target: \"#root.dm.help\",\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === \"help\";\n            }\n          }, {\n            target: \"#root.dm.quit\",\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === \"quit\";\n            }\n          }],\n          onError: {\n            target: \"#root.dm.error\"\n          }\n        }\n      }\n    }\n  };\n}\n\nfunction repeatQuestion2(currentState, question, target1, intent1, target2, intent2) {\n  return {\n    initial: \"prompt\",\n    on: {\n      RECOGNISED: {\n        target: \".rasa\"\n      }\n    },\n    states: {\n      prompt: {\n        entry: say(question),\n        on: {\n          ENDSPEECH: \"ask\"\n        }\n      },\n      ask: {\n        entry: listen()\n      },\n      rasa: {\n        invoke: {\n          id: 'rasa',\n          src: function src(context, event) {\n            return nluRequest(context.recResult);\n          },\n          onDone: [{\n            target: \"#root.dm.game.\".concat(target1),\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === intent1;\n            }\n          }, {\n            target: \"#root.dm.game.\".concat(target2),\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === intent2;\n            }\n          }, {\n            target: \"#root.dm.error\",\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\";\n            }\n          }, {\n            target: \"#root.dm.help\",\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === \"help\";\n            }\n          }, {\n            target: \"#root.dm.quit\",\n            cond: function cond(context, event) {\n              return event.data.intent[\"name\"] === \"quit\";\n            }\n          }],\n          onError: {\n            target: \"#root.dm.error\"\n          }\n        }\n      }\n    }\n  };\n}\n\nexport var dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'welcome'\n      }\n    },\n    welcome: {\n      initial: \"prompt1\",\n      on: {\n        RECOGNISED: {\n          target: \".rasa\"\n        }\n      },\n      states: {\n        prompt1: {\n          entry: say(\"Welcome to MLT Maze Game! This is a dialogue-based game where you will try to reach your goal by choosing the best route. Are you ready?\"),\n          on: {\n            ENDSPEECH: \"ask\"\n          }\n        },\n        prompt2: {\n          entry: say(\"I said: ARE YOU READY?\"),\n          on: {\n            ENDSPEECH: \"ask\"\n          }\n        },\n        ask: {\n          entry: listen()\n        },\n        rasa: {\n          invoke: {\n            id: 'rasa',\n            src: function src(context, event) {\n              return nluRequest(context.recResult);\n            },\n            onDone: [{\n              target: \"#root.dm.game\",\n              cond: function cond(context, event) {\n                return event.data.intent[\"name\"] === \"affirm\";\n              }\n            }, {\n              target: \"#root.dm.help\",\n              cond: function cond(context, event) {\n                return event.data.intent[\"name\"] === \"help\";\n              }\n            }, {\n              target: \"#root.dm.welcome\",\n              cond: function cond(context, event) {\n                return event.data.intent[\"name\"] === \"repeat\";\n              }\n            }, {\n              target: \"#root.dm.welcome.prompt2\",\n              cond: function cond(context, event) {\n                return event.data.intent[\"name\"] !== \"affirm\" && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" && event.data.intent[\"name\"] !== \"repeat\";\n              }\n            }, {\n              target: \"#root.dm.quit\",\n              cond: function cond(context, event) {\n                return event.data.intent[\"name\"] === \"quit\";\n              }\n            }],\n            onError: {\n              target: \"#root.dm.error\"\n            }\n          }\n        }\n      }\n    },\n    game: {\n      initial: \"start\",\n      states: {\n        hist: {\n          type: 'history'\n        },\n        start: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \"humanisten\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"Great! Let’s play! It's a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. Your classmates are already celebrating in a bar on Andra Longgatan. You need to get there before they finish their drinks and go home. But since you are new in town, you don't know the way.\"),\n              on: {\n                ENDSPEECH: \"#root.dm.game.textMessage\"\n              }\n            }\n          }\n        },\n        textMessage: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"On your way out of Humanisten you receive a text message from a classmate. Do you open it?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            read: {\n              entry: say(\"The message says: You need to go to Järntorget. You can take tram number 3 or tram number 6 to get there.\"),\n              on: {\n                ENDSPEECH: \"#root.dm.game.humanisten\"\n              }\n            },\n            rasa: rasaParse('textMessage', 'textMessage.read', 'affirm', 'humanisten', 'deny'),\n            repeat1: repeatQuestion(\"textMessage\", \"Sorry, I didn't catch that. Do you read the message?\", 'textMessage.read', 'affirm', 'humanisten', 'deny'),\n            repeat2: repeatQuestion2(\"textMessage\", \"I still don't understand you. Say yes if you want to read the message and no if you don't.\", 'textMessage.read', 'affirm', 'humanisten', 'deny')\n          }\n        },\n        humanisten: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You exit the building and realize you don't even know where the nearest tram stop is. To your right you see some stairs that go downhill. Ahead of you is the statue of Poseidon. Do you go down the stairs or do you head towards Poseidon?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('humanisten', 'gotaplatsen', 'poseidon', 'korsvagen', 'stairs'),\n            repeat1: repeatQuestion(\"humanisten\", \"Sorry, I didn't catch that. Do you go down the stairs or do you head towards Poseidon?\", 'gotaplatsen', 'poseidon', 'korsvagen', 'stairs'),\n            repeat2: repeatQuestion2(\"humanisten\", \"I still don't understand you. Say yes for the stairs and no for Poseidon\", 'gotaplatsen', 'affirm', 'korsvagen', 'deny')\n          }\n        },\n        gotaplatsen: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              actions: assign(function (context) {\n                return {\n                  gotaplatsen: true\n                };\n              }),\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You start to walk straight ahead and soon you find yourself at Götaplatsen. The majesty of Poseidon simply takes your breath away. But when you reach the public transport stop there are no trams there, only busses. Do you continue to walk down the street or do you jump on a bus?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('gotaplatsen', 'valand', 'walk', 'brunnsparken', 'bus'),\n            repeat1: repeatQuestion('gotaplatsen', \"Sorry, I didn't catch that. Do you go continue to walk or do you take a bus?\", 'valand', 'walk', 'brunnsparken', 'bus'),\n            repeat2: repeatQuestion2('gotaplatsen', \"I still don't understand you. Say yes for walking and no for the bus\", 'valand', 'affirm', 'brunnsparken', 'deny')\n          }\n        },\n        niceLady: {},\n        korsvagen: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              actions: assign(function (context) {\n                return {\n                  korsvagen: true\n                };\n              }),\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You start walking down the steep stairs and find yourself at Korsvegen. It is more of a construction site than a tram stop. Suddenly see tram number 6. The doors are about to close but you can make it if you hurry! Do you run to catch it?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('korsvagen', 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny'),\n            repeat1: repeatQuestion('korsvagen', \"Sorry I didn't catch that. Do you take the tram?\", 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny'),\n            repeat2: repeatQuestion2('korsvagen', \"I still don't understand. Do you take the tram: yes or no?\", 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny')\n          }\n        },\n        brunnsparken: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              actions: assign(function (context) {\n                return {\n                  brunnsparken: true\n                };\n              }),\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You jump on the first bus you see. After just a few stops, you get off at Brunnsparken. You look around and see that the trams 6 and 1 depart from here. Which one do you take?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            prompt2: {\n              entry: say(\"Since you don’t feel like running in public, you stand still and watch tram 6 depart. Instead, you take tram 4 to Brunnsparken and decide to change to another tram line there. When you reach Brunnsparken, you get off the tram and look around. You see that both number 6 and 1 depart from here. Which one do you take?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('brunnsparken', 'jarntorget.prompt2', 'one', 'hjalmarbranting', 'six'),\n            repeat1: repeatQuestion('brunnsparken', \"Sorry I didn't catch that. Do you take tram 1 or tram 6?\", 'jarntorget.prompt2', 'one', 'hjalmarbranting', 'six'),\n            repeat2: repeatQuestion2('brunnsparken', \"I still don't understand. Say yes for tram 1 and no for tram 6.\", 'jarntorget.prompt2', 'affirm', 'hjalmarbranting', 'deny')\n          }\n        },\n        valand: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You continue to walk down Avenyn and you’re in a great mood. You reach the tram stop at Valand and look at the monitor. But what? Due to a technical error, there is currently no tram traffic between Valand and Järntorget. Your options now are to continue to walk towards Järntorget or to take a tram down to Brunnsparken. What do you do?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('valand', 'vasaplatsen', 'walk', 'brunnsparken', 'tram'),\n            repeat1: {},\n            repeat2: {}\n          }\n        },\n        vasaplatsen: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              actions: assign(function (context) {\n                return {\n                  vasaplatsen: true\n                };\n              }),\n              target: \".rasa\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"You continue to walk along Vasagatan. It’s a beautiful walk with elmtrees on both sides. You reach the tram stop at Vasaplatsen and check the monitor. But no, there are still no trams passing. You start to feel tired from all the walking and see a station of the public city bikes. Do you take a bike or do you continue to walk?\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            },\n            rasa: rasaParse('vasaplatsen', 'styrostall', 'bike', 'jarntorget', 'walk'),\n            repeat1: repeatQuestion('vasaplatsen', \"Sorry I didn't catch that. Do you take a bike or do you continue to walk?\", 'styrostall', 'bike', 'jarntorget', 'walk'),\n            repeat2: repeatQuestion2('vasaplatsen', \"I still don't get it. Say yes for bike or no for walking.\", 'styrostall', 'affirm', 'jarntorget', 'deny')\n          }\n        },\n        jarntorget: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \"andralang\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"After a long walk you finally reach Järntorget and there it is: Andra Longgatan! Just a few meters left to walk…\"),\n              on: {\n                ENDSPEECH: \"#root.dm.game.andralang\"\n              }\n            },\n            prompt2: {\n              entry: say(\"You board tram number 1 and get off at Järntorget. Finally you see it: Andra Longgatan! Just a few meters left to walk…\"),\n              on: {\n                ENDSPEECH: \"#root.dm.game.andralang\"\n              }\n            }\n          }\n        },\n        andralang: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \"win\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"While you’re walking along the bar street you see how the sky turns pink. You take a deep breath of the spring air and think to yourself how much you love this city. Suddenly, you see a group of people smiling and waving to you from inside one of the bars. It’s your classmates!\"),\n              on: {\n                ENDSPEECH: \"#root.dm.game.win\"\n              }\n            }\n          }\n        },\n        kortedala: {\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"You hurry towards the tram and manage to get inside, just as the doors close behind you. You wait for the name ”Järntorget” to show up on the monitor. When you pass Redbergsplatsen you get a bad feeling and ask the man next to you if tram number 6 really goes to Järntorget. He says it does, but in the opposite direction! You are now halfway to Kortedala and realize you will never make it to the bar in time.\"),\n              on: {\n                ENDSPEECH: {\n                  actions: assign(function (context) {\n                    return {\n                      kortedala: true\n                    };\n                  }),\n                  target: \"#root.dm.game.gameover\"\n                }\n              }\n            }\n          }\n        },\n        hjalmarbranting: {\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"You board tram number 6, confident that it will take you to Järntorget. After just one stop, you find yourself on a bridge! The view of the city and Göta River is wonderful, but this can’t be right… You ask the woman next to you if tram number 6 really goes to Järntorget. She says it does, but in the opposite direction! You are now on Hisingen island and there is no way you will make it to the bar in time.\"),\n              on: {\n                ENDSPEECH: {\n                  actions: assign(function (context) {\n                    return {\n                      hjalmarbranting: true\n                    };\n                  }),\n                  target: \"#root.dm.game.gameover\"\n                }\n              }\n            }\n          }\n        },\n        styrostall: {\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"You approach the bike terminal and read the instructions in English. Apparently you need to download an app and register with your credit card. When you finally manage to get a bike, you have lost valuable time. You start to pedal as fast as you can towards Järntorget when you’re suddenly thrown off the bike. The front weel got stuck in one of the tram tracks. You feel a terrible pain in your arm and need to go the hospital. Your classmates will have to celebrate without you…\"),\n              on: {\n                ENDSPEECH: {\n                  actions: assign(function (context) {\n                    return {\n                      styrostall: true\n                    };\n                  }),\n                  target: \"#root.dm.game.gameover\"\n                }\n              }\n            }\n          }\n        },\n        win: {\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"Congratulations! You won!\"),\n              on: {\n                ENDSPEECH: [{\n                  target: 'gold',\n                  cond: function cond(context) {\n                    return context.brunnsparken;\n                  }\n                }, {\n                  target: 'silver',\n                  cond: function cond(context) {\n                    return context.vasaplatsen;\n                  }\n                }, {\n                  target: 'goodbye'\n                }]\n              }\n            },\n            gold: {\n              entry: say(\"Your strategy of changing tram in Brunnsparken awards you with a gold medal.\"),\n              on: {\n                ENDSPEECH: \"goodbye\"\n              }\n            },\n            silver: {\n              entry: say(\"Your strategy of walking the whole way awards you with a silver medal. Sometimes, that's the fastest way get around in central Gothenburg.\"),\n              on: {\n                ENDSPEECH: \"goodbye\"\n              }\n            },\n            bronze: {\n              entry: say(\"What we can learn from this is that you should never take tram number 6 since you will always take it in the wrong direction.\"),\n              on: {\n                ENDSPEECH: \"goodbye\"\n              }\n            },\n            goodbye: {\n              entry: say(\"Click on the screen if you want to play again.\"),\n              on: {\n                ENDSPEECH: \"#root.dm\"\n              }\n            }\n          }\n        },\n        gameover: {\n          initial: \"prompt\",\n          states: {\n            prompt: {\n              entry: say(\"You lost! You didn't make it to the bar in time.\"),\n              on: {\n                ENDSPEECH: [{\n                  target: 'styrostall',\n                  cond: function cond(context) {\n                    return context.styrostall;\n                  }\n                }, {\n                  target: 'tram6',\n                  cond: function cond(context) {\n                    return context.hjalmarbranting || context.kortedala;\n                  }\n                }, {\n                  target: 'goodbye'\n                }]\n              }\n            },\n            styrostall: {\n              entry: say(\"I hope you have learned that it's dangerous to cykle on tram tracks.\"),\n              on: {\n                ENDSPEECH: \"goodbye\"\n              }\n            },\n            tram6: {\n              entry: say(\"What we can learn from this is that you should never take tram number 6 since you will always take it in the wrong direction.\"),\n              on: {\n                ENDSPEECH: \"goodbye\"\n              }\n            },\n            goodbye: {\n              entry: say(\"Click on the screen if you want to try again.\"),\n              on: {\n                ENDSPEECH: \"#root.dm\"\n              }\n            }\n          }\n        }\n      }\n    },\n    help: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"Try to answer the questions as clearly as you can. Say: repeat, if you want me to repeat the question. Say: quit, if you want to quit the game.\"),\n          on: {\n            ENDSPEECH: \"#root.dm.game.hist\"\n          }\n        }\n      }\n    },\n    quit: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"Goodbye! Come back anytime if you want to play again.\"),\n          on: {\n            ENDSPEECH: \"#root.dm\"\n          }\n        }\n      }\n    },\n    error: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"Something went wrong. Please restart the game and try again.\"),\n          on: {\n            ENDSPEECH: \"#root.dm\"\n          }\n        }\n      }\n    },\n    repeat: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"Ok. I will repeat.\"),\n          on: {\n            ENDSPEECH: \"#root.dm.game.hist\"\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/mnt/c/Users/batst/LWshare/dialogue-systems-2021/course-project-klara-bastedt/src/dmGame.ts"],"names":["send","assign","nluRequest","say","text","_context","type","value","listen","rasaParse","currentState","target1","intent1","target2","intent2","invoke","id","src","context","event","recResult","onDone","target","cond","data","intent","onError","repeatQuestion","question","initial","on","RECOGNISED","states","prompt","entry","ENDSPEECH","ask","rasa","repeatQuestion2","dmMachine","init","CLICK","welcome","prompt1","prompt2","game","hist","start","textMessage","read","repeat1","repeat2","humanisten","gotaplatsen","actions","niceLady","korsvagen","brunnsparken","valand","vasaplatsen","jarntorget","andralang","kortedala","hjalmarbranting","styrostall","win","gold","silver","bronze","goodbye","gameover","tram6","help","quit","error","repeat"],"mappings":"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","sourcesContent":["import { MachineConfig, send, Action, assign } from \"xstate\";\nimport { nluRequest } from \"./index\"\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nfunction rasaParse(currentState: string, target1: string, intent1: string, target2: string, intent2: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        invoke: {\n            id: 'rasa',\n            src: (context, event) => nluRequest(context.recResult),\n            onDone: [\n                { target: `#root.dm.game.${target1}`, cond: (context, event) => event.data.intent[\"name\"] === intent1 },\n                { target: `#root.dm.game.${target2}`, cond: (context, event) => event.data.intent[\"name\"] === intent2 },\n                { target: `#root.dm.game.${currentState}.repeat1`, cond: (context, event) => event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" && event.data.intent[\"name\"] !== \"repeat\"},\n                { target: \"#root.dm.game.hist\", cond: (context, event) => event.data.intent[\"name\"] === \"repeat\" },                    \n                { target: \"#root.dm.help\", cond: (context, event) => event.data.intent[\"name\"] === \"help\" },\n                { target: \"#root.dm.quit\", cond: (context, event) => event.data.intent[\"name\"] === \"quit\" }],\n            onError: {\n                    target: '#root.dm.error',\n                }\n        }\n    })\n}\n\nfunction repeatQuestion(currentState: string, question: string, target1: string, intent1: string, target2: string, intent2: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: \"prompt\",\n        on: {\n            RECOGNISED: {\n                target: \".rasa\",\n            }\n        },\n        states: {\n            prompt: {\n                entry: say(question),\n                on: { ENDSPEECH: \"ask\" }\n            },\n            ask: {\n                entry: listen()\n            },\n            rasa: {\n                invoke: {\n                    id: 'rasa',\n                    src: (context, event) => nluRequest(context.recResult),\n                    onDone: [\n                        { target: `#root.dm.game.${target1}`, cond: (context, event) => event.data.intent[\"name\"] === intent1 },\n                        { target: `#root.dm.game.${target2}`, cond: (context, event) => event.data.intent[\"name\"] === intent2 },\n                        { target: `#root.dm.game.${currentState}.repeat2`, cond: (context, event) => event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" },\n                        { target: \"#root.dm.help\", cond: (context, event) => event.data.intent[\"name\"] === \"help\" },\n                        { target: \"#root.dm.quit\", cond: (context, event) => event.data.intent[\"name\"] === \"quit\" }],\n                    onError: {\n                        target: \"#root.dm.error\",\n                    }\n                }\n            }\n        }\n    })\n}\n\nfunction repeatQuestion2(currentState: string, question: string, target1: string, intent1: string, target2: string, intent2: string): MachineConfig<SDSContext, any, SDSEvent> {\n    return ({\n        initial: \"prompt\",\n        on: {\n            RECOGNISED: {\n                target: \".rasa\",\n            }\n        },\n        states: {\n            prompt: {\n                entry: say(question),\n                on: { ENDSPEECH: \"ask\" }\n            },\n            ask: {\n                entry: listen()\n            },\n            rasa: {\n                invoke: {\n                    id: 'rasa',\n                    src: (context, event) => nluRequest(context.recResult),\n                    onDone: [\n                        { target: `#root.dm.game.${target1}`, cond: (context, event) => event.data.intent[\"name\"] === intent1 },\n                        { target: `#root.dm.game.${target2}`, cond: (context, event) => event.data.intent[\"name\"] === intent2 },\n                        { target: \"#root.dm.error\", cond: (context, event) => event.data.intent[\"name\"] !== intent1 && event.data.intent[\"name\"] !== intent2 && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" },\n                        { target: \"#root.dm.help\", cond: (context, event) => event.data.intent[\"name\"] === \"help\" },\n                        { target: \"#root.dm.quit\", cond: (context, event) => event.data.intent[\"name\"] === \"quit\" }],\n                    onError: {\n                        target: \"#root.dm.error\",\n                    }\n                }\n            }\n        }\n    })\n}\n\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            initial: \"prompt1\",\n            on: {\n                RECOGNISED: {\n                    target: \".rasa\",\n                }\n            },\n            states: {\n                prompt1: {\n                    entry: say(\"Welcome to MLT Maze Game! This is a dialogue-based game where you will try to reach your goal by choosing the best route. Are you ready?\"),\n                    on: { ENDSPEECH: \"ask\" }\n                },\n                prompt2: {\n                    entry: say(\"I said: ARE YOU READY?\"),\n                    on: { ENDSPEECH: \"ask\" }\n                },\n                ask: {\n                    entry: listen()\n                },\n                rasa: {\n                    invoke: {\n                        id: 'rasa',\n                        src: (context, event) => nluRequest(context.recResult),\n                        onDone: [\n                            { target: \"#root.dm.game\", cond: (context, event) => event.data.intent[\"name\"] === \"affirm\" },\n                            { target: \"#root.dm.help\", cond: (context, event) => event.data.intent[\"name\"] === \"help\" },\n                            { target: \"#root.dm.welcome\", cond: (context, event) => event.data.intent[\"name\"] === \"repeat\" },\n                            { target: \"#root.dm.welcome.prompt2\", cond: (context, event) => event.data.intent[\"name\"] !== \"affirm\" && event.data.intent[\"name\"] !== \"help\" && event.data.intent[\"name\"] !== \"quit\" && event.data.intent[\"name\"] !== \"repeat\" },\n                            { target: \"#root.dm.quit\", cond: (context, event) => event.data.intent[\"name\"] === \"quit\" }],\n                        onError: {\n                            target: \"#root.dm.error\",\n                        }\n                    }\n                }\n            }\n        },\n        game: {\n            initial: \"start\",\n            states: {\n                hist: { type: 'history' },\n                start: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \"humanisten\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"Great! Let’s play! It's a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. Your classmates are already celebrating in a bar on Andra Longgatan. You need to get there before they finish their drinks and go home. But since you are new in town, you don't know the way.\"),\n                            on: { ENDSPEECH: \"#root.dm.game.textMessage\" }\n                        }\n                    }\n                },\n                textMessage: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \".rasa\"\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"On your way out of Humanisten you receive a text message from a classmate. Do you open it?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        read: {entry: say(\"The message says: You need to go to Järntorget. You can take tram number 3 or tram number 6 to get there.\"),\n                    on: { ENDSPEECH: \"#root.dm.game.humanisten\" }\n                },\n                        rasa: rasaParse('textMessage', 'textMessage.read', 'affirm', 'humanisten', 'deny'),\n                        repeat1: repeatQuestion(\"textMessage\", \"Sorry, I didn't catch that. Do you read the message?\", 'textMessage.read', 'affirm', 'humanisten', 'deny'),\n                        repeat2: repeatQuestion2(\"textMessage\", \"I still don't understand you. Say yes if you want to read the message and no if you don't.\", 'textMessage.read', 'affirm', 'humanisten', 'deny'),\n                    }\n                },\n                humanisten: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \".rasa\"\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You exit the building and realize you don't even know where the nearest tram stop is. To your right you see some stairs that go downhill. Ahead of you is the statue of Poseidon. Do you go down the stairs or do you head towards Poseidon?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('humanisten', 'gotaplatsen', 'poseidon', 'korsvagen', 'stairs'),\n                        repeat1: repeatQuestion(\"humanisten\", \"Sorry, I didn't catch that. Do you go down the stairs or do you head towards Poseidon?\", 'gotaplatsen', 'poseidon', 'korsvagen', 'stairs'),\n                        repeat2: repeatQuestion2(\"humanisten\", \"I still don't understand you. Say yes for the stairs and no for Poseidon\", 'gotaplatsen', 'affirm', 'korsvagen', 'deny'),\n                    }\n                },\n                gotaplatsen: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: { actions: assign((context) => { return { gotaplatsen: true } }), \n                            target: \".rasa\"},\n                        \n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You start to walk straight ahead and soon you find yourself at Götaplatsen. The majesty of Poseidon simply takes your breath away. But when you reach the public transport stop there are no trams there, only busses. Do you continue to walk down the street or do you jump on a bus?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('gotaplatsen', 'valand', 'walk', 'brunnsparken', 'bus'),\n                        repeat1: repeatQuestion('gotaplatsen', \"Sorry, I didn't catch that. Do you go continue to walk or do you take a bus?\", 'valand', 'walk', 'brunnsparken', 'bus'),\n                        repeat2: repeatQuestion2('gotaplatsen', \"I still don't understand you. Say yes for walking and no for the bus\", 'valand', 'affirm', 'brunnsparken', 'deny')\n                    }\n                },\n                niceLady: {},\n                korsvagen: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: { actions: assign((context) => { return { korsvagen: true } }), \n                            target: \".rasa\"}\n                        \n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You start walking down the steep stairs and find yourself at Korsvegen. It is more of a construction site than a tram stop. Suddenly see tram number 6. The doors are about to close but you can make it if you hurry! Do you run to catch it?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('korsvagen', 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny'),\n                        repeat1: repeatQuestion('korsvagen', \"Sorry I didn't catch that. Do you take the tram?\", 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny'),\n                        repeat2: repeatQuestion2('korsvagen', \"I still don't understand. Do you take the tram: yes or no?\", 'kortedala', 'affirm', 'brunnsparken.prompt2', 'deny')\n                    }\n                },\n                brunnsparken: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: { actions: assign((context) => { return { brunnsparken: true } }), \n                            target: \".rasa\"},\n                        \n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You jump on the first bus you see. After just a few stops, you get off at Brunnsparken. You look around and see that the trams 6 and 1 depart from here. Which one do you take?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        prompt2: {\n                            entry: say(\"Since you don’t feel like running in public, you stand still and watch tram 6 depart. Instead, you take tram 4 to Brunnsparken and decide to change to another tram line there. When you reach Brunnsparken, you get off the tram and look around. You see that both number 6 and 1 depart from here. Which one do you take?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('brunnsparken', 'jarntorget.prompt2', 'one', 'hjalmarbranting', 'six'),\n                        repeat1: repeatQuestion('brunnsparken', \"Sorry I didn't catch that. Do you take tram 1 or tram 6?\", 'jarntorget.prompt2', 'one', 'hjalmarbranting', 'six'),\n                        repeat2: repeatQuestion2('brunnsparken', \"I still don't understand. Say yes for tram 1 and no for tram 6.\", 'jarntorget.prompt2', 'affirm', 'hjalmarbranting', 'deny'),\n                    }\n                },\n                valand: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \".rasa\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You continue to walk down Avenyn and you’re in a great mood. You reach the tram stop at Valand and look at the monitor. But what? Due to a technical error, there is currently no tram traffic between Valand and Järntorget. Your options now are to continue to walk towards Järntorget or to take a tram down to Brunnsparken. What do you do?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('valand', 'vasaplatsen', 'walk', 'brunnsparken', 'tram'),\n                        repeat1: {},\n                        repeat2: {}\n                    }\n                },\n                vasaplatsen: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: { actions: assign((context) => { return { vasaplatsen: true } }), \n                            target: \".rasa\"},\n                        \n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"You continue to walk along Vasagatan. It’s a beautiful walk with elmtrees on both sides. You reach the tram stop at Vasaplatsen and check the monitor. But no, there are still no trams passing. You start to feel tired from all the walking and see a station of the public city bikes. Do you take a bike or do you continue to walk?\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        },\n                        rasa: rasaParse('vasaplatsen', 'styrostall', 'bike', 'jarntorget', 'walk'),\n                        repeat1: repeatQuestion('vasaplatsen', \"Sorry I didn't catch that. Do you take a bike or do you continue to walk?\", 'styrostall', 'bike', 'jarntorget', 'walk'),\n                        repeat2: repeatQuestion2('vasaplatsen', \"I still don't get it. Say yes for bike or no for walking.\", 'styrostall', 'affirm', 'jarntorget', 'deny')\n                    }\n                },\n                jarntorget: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \"andralang\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"After a long walk you finally reach Järntorget and there it is: Andra Longgatan! Just a few meters left to walk…\"),\n                            on: { ENDSPEECH: \"#root.dm.game.andralang\" }\n                        },\n                        prompt2: {\n                            entry: say(\"You board tram number 1 and get off at Järntorget. Finally you see it: Andra Longgatan! Just a few meters left to walk…\"),\n                            on: { ENDSPEECH: \"#root.dm.game.andralang\" }\n                        }\n                    }\n                },\n                andralang: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \"win\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"While you’re walking along the bar street you see how the sky turns pink. You take a deep breath of the spring air and think to yourself how much you love this city. Suddenly, you see a group of people smiling and waving to you from inside one of the bars. It’s your classmates!\"),\n                            on: { ENDSPEECH: \"#root.dm.game.win\" }\n                        }\n                    }\n                },\n                kortedala: {\n                    initial: \"prompt\",\n                    states: {\n                        prompt: {\n                            entry: say(\"You hurry towards the tram and manage to get inside, just as the doors close behind you. You wait for the name ”Järntorget” to show up on the monitor. When you pass Redbergsplatsen you get a bad feeling and ask the man next to you if tram number 6 really goes to Järntorget. He says it does, but in the opposite direction! You are now halfway to Kortedala and realize you will never make it to the bar in time.\"),\n                            on: { ENDSPEECH: { actions: assign((context) => { return { kortedala: true } }), \n                            target: \"#root.dm.game.gameover\" }}\n                        }\n                    }\n                },\n                hjalmarbranting: {\n                    initial: \"prompt\",\n                    states: {\n                        prompt: {\n                            entry: say(\"You board tram number 6, confident that it will take you to Järntorget. After just one stop, you find yourself on a bridge! The view of the city and Göta River is wonderful, but this can’t be right… You ask the woman next to you if tram number 6 really goes to Järntorget. She says it does, but in the opposite direction! You are now on Hisingen island and there is no way you will make it to the bar in time.\"),\n                            on: { ENDSPEECH: { actions: assign((context) => { return { hjalmarbranting: true } }), \n                            target: \"#root.dm.game.gameover\" }}\n                        }\n                    }\n                },\n                styrostall: {\n                    initial: \"prompt\",\n                    states: {\n                        prompt: {\n                            entry: say(\"You approach the bike terminal and read the instructions in English. Apparently you need to download an app and register with your credit card. When you finally manage to get a bike, you have lost valuable time. You start to pedal as fast as you can towards Järntorget when you’re suddenly thrown off the bike. The front weel got stuck in one of the tram tracks. You feel a terrible pain in your arm and need to go the hospital. Your classmates will have to celebrate without you…\"),\n                            on: { ENDSPEECH: { actions: assign((context) => { return { styrostall: true } }), \n                            target: \"#root.dm.game.gameover\" }}\n                        }\n                    }\n                },\n                win: {\n                    initial: \"prompt\",\n                    states: {\n                        prompt: {\n                            entry: say(\"Congratulations! You won!\"),\n                            on: { ENDSPEECH: [\n                                {\n                                  target: 'gold',\n                                  cond: (context) => context.brunnsparken,\n                                },\n                                {\n                                    target: 'silver',\n                                    cond: (context) => context.vasaplatsen,\n                                  },\n                                { target: 'goodbye' }\n                              ] }\n                        },\n                        gold: {\n                            entry: say(\"Your strategy of changing tram in Brunnsparken awards you with a gold medal.\"),\n                            on: { ENDSPEECH: \"goodbye\" }\n                        },\n                        silver: {\n                            entry: say(\"Your strategy of walking the whole way awards you with a silver medal. Sometimes, that's the fastest way get around in central Gothenburg.\"),\n                            on: { ENDSPEECH: \"goodbye\" }\n                        },\n                        bronze: {\n                            entry: say(\"What we can learn from this is that you should never take tram number 6 since you will always take it in the wrong direction.\"),\n                            on: { ENDSPEECH: \"goodbye\" }\n                        },\n                        goodbye: {\n                            entry: say(\"Click on the screen if you want to play again.\"),\n                            on: { ENDSPEECH: \"#root.dm\" }\n                        }\n                    }\n                },\n                gameover: {\n                    initial: \"prompt\",\n                    states: {\n                        prompt: {\n                            entry: say(\"You lost! You didn't make it to the bar in time.\"),\n                            on: { ENDSPEECH: [\n                                {\n                                  target: 'styrostall',\n                                  cond: (context) => context.styrostall,\n                                },\n                                {\n                                    target: 'tram6',\n                                    cond: (context) => context.hjalmarbranting || context.kortedala,\n                                  },\n                                { target: 'goodbye' }\n                              ] }\n                        },\n                        styrostall: {\n                            entry: say(\"I hope you have learned that it's dangerous to cykle on tram tracks.\"),\n                            on: { ENDSPEECH: \"goodbye\" }\n                        },\n                        tram6: {\n                            entry: say(\"What we can learn from this is that you should never take tram number 6 since you will always take it in the wrong direction.\"),\n                            on: { ENDSPEECH: \"goodbye\" }\n                        },\n                        goodbye: {\n                            entry: say(\"Click on the screen if you want to try again.\"),\n                            on: { ENDSPEECH: \"#root.dm\" }\n                        }\n                    }\n                },\n            }\n        },\n        help: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"Try to answer the questions as clearly as you can. Say: repeat, if you want me to repeat the question. Say: quit, if you want to quit the game.\"),\n                    on: { ENDSPEECH: \"#root.dm.game.hist\" }\n                }\n            }\n        },\n        quit: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"Goodbye! Come back anytime if you want to play again.\"),\n                    on: { ENDSPEECH: \"#root.dm\" }\n                }\n            }\n        },\n        error: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"Something went wrong. Please restart the game and try again.\"),\n                    on: { ENDSPEECH: \"#root.dm\" }\n                }\n            }\n        },\n        repeat: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"Ok. I will repeat.\"),\n                    on: { ENDSPEECH: \"#root.dm.game.hist\" }\n                }\n            }\n        },\n\n    }\n})"]},"metadata":{},"sourceType":"module"}