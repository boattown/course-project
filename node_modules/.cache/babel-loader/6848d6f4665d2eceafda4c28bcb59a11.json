{"ast":null,"code":"import _objectSpread from \"/mnt/c/Users/batst/LWshare/dialogue-systems-2021/course-project-klara-bastedt/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { send } from \"xstate\";\nimport { nluRequest } from \"./index\";\n\nfunction say(text) {\n  return send(function (_context) {\n    return {\n      type: \"SPEAK\",\n      value: text\n    };\n  });\n}\n\nfunction listen() {\n  return send('LISTEN');\n}\n\nexport var dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'welcome'\n      }\n    },\n    welcome: {\n      initial: \"prompt\",\n      on: {\n        RECOGNISED: {\n          target: \"invoking_rasa\"\n        }\n      },\n      states: {\n        prompt: {\n          entry: say(\"Welcome! I can help you schedule a meeting, set an alarm and add to your to do list. What would you like to do?\"),\n          on: {\n            ENDSPEECH: \"ask\"\n          }\n        },\n        ask: {\n          entry: listen()\n        }\n      }\n    },\n    invoking_rasa: {\n      invoke: {\n        id: 'rasa',\n        src: function src(context, event) {\n          return nluRequest(context.recResult);\n        },\n        onDone: [{\n          target: \"appointment\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"appointments\";\n          }\n        }, {\n          target: \"timer\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"timer\";\n          }\n        }, {\n          target: \"todoList\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"todo_item\";\n          }\n        }],\n        onError: {\n          target: 'welcome'\n        }\n      }\n    },\n    appointment: _objectSpread({}, dmMachine),\n    timer: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"OK. I will help you set a timer.\"),\n          on: {\n            ENDSPEECH: \"#root.dm\"\n          }\n        }\n      }\n    },\n    todoList: {\n      initial: \"prompt\",\n      states: {\n        prompt: {\n          entry: say(\"OK. Let's add to your to do list!\"),\n          on: {\n            ENDSPEECH: \"#root.dm\"\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["/mnt/c/Users/batst/LWshare/dialogue-systems-2021/course-project-klara-bastedt/src/dmGame.ts"],"names":["send","nluRequest","say","text","_context","type","value","listen","dmMachine","initial","states","init","on","CLICK","welcome","RECOGNISED","target","prompt","entry","ENDSPEECH","ask","invoking_rasa","invoke","id","src","context","event","recResult","onDone","cond","data","intent","onError","appointment","timer","todoList"],"mappings":";AAAA,SAAwBA,IAAxB,QAA4C,QAA5C;AACA,SAASC,UAAT,QAA2B,SAA3B;;AAEA,SAASC,GAAT,CAAaC,IAAb,EAAyD;AACrD,SAAOH,IAAI,CAAC,UAACI,QAAD;AAAA,WAA2B;AAAEC,MAAAA,IAAI,EAAE,OAAR;AAAiBC,MAAAA,KAAK,EAAEH;AAAxB,KAA3B;AAAA,GAAD,CAAX;AACH;;AAED,SAASI,MAAT,GAAgD;AAC5C,SAAOP,IAAI,CAAC,QAAD,CAAX;AACH;;AAED,OAAO,IAAMQ,SAAmD,GAAI;AAChEC,EAAAA,OAAO,EAAE,MADuD;AAEhEC,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAE;AACFC,MAAAA,EAAE,EAAE;AACAC,QAAAA,KAAK,EAAE;AADP;AADF,KADF;AAMJC,IAAAA,OAAO,EAAE;AACLL,MAAAA,OAAO,EAAE,QADJ;AAELG,MAAAA,EAAE,EAAE;AACAG,QAAAA,UAAU,EAAE;AACRC,UAAAA,MAAM,EAAE;AADA;AADZ,OAFC;AAOLN,MAAAA,MAAM,EAAE;AACJO,QAAAA,MAAM,EAAE;AACJC,UAAAA,KAAK,EAAEhB,GAAG,CAAC,iHAAD,CADN;AAEJU,UAAAA,EAAE,EAAE;AAAEO,YAAAA,SAAS,EAAE;AAAb;AAFA,SADJ;AAKJC,QAAAA,GAAG,EAAE;AACDF,UAAAA,KAAK,EAAEX,MAAM;AADZ;AALD;AAPH,KANL;AAuBJc,IAAAA,aAAa,EAAE;AACXC,MAAAA,MAAM,EAAE;AACJC,QAAAA,EAAE,EAAE,MADA;AAEJC,QAAAA,GAAG,EAAE,aAACC,OAAD,EAAUC,KAAV;AAAA,iBAAoBzB,UAAU,CAACwB,OAAO,CAACE,SAAT,CAA9B;AAAA,SAFD;AAGJC,QAAAA,MAAM,EAAE,CACJ;AAAEZ,UAAAA,MAAM,EAAE,aAAV;AAAyBa,UAAAA,IAAI,EAAE,cAACJ,OAAD,EAAUC,KAAV;AAAA,mBAAoBA,KAAK,CAACI,IAAN,CAAWC,MAAX,CAAkB,MAAlB,MAA8B,cAAlD;AAAA;AAA/B,SADI,EAEJ;AAAEf,UAAAA,MAAM,EAAE,OAAV;AAAmBa,UAAAA,IAAI,EAAE,cAACJ,OAAD,EAAUC,KAAV;AAAA,mBAAoBA,KAAK,CAACI,IAAN,CAAWC,MAAX,CAAkB,MAAlB,MAA8B,OAAlD;AAAA;AAAzB,SAFI,EAGJ;AAAEf,UAAAA,MAAM,EAAE,UAAV;AAAsBa,UAAAA,IAAI,EAAE,cAACJ,OAAD,EAAUC,KAAV;AAAA,mBAAoBA,KAAK,CAACI,IAAN,CAAWC,MAAX,CAAkB,MAAlB,MAA8B,WAAlD;AAAA;AAA5B,SAHI,CAHJ;AAOJC,QAAAA,OAAO,EAAE;AACLhB,UAAAA,MAAM,EAAE;AADH;AAPL;AADG,KAvBX;AAsCJiB,IAAAA,WAAW,oBACJzB,SADI,CAtCP;AAyCJ0B,IAAAA,KAAK,EAAE;AACHzB,MAAAA,OAAO,EAAE,QADN;AAEHC,MAAAA,MAAM,EAAE;AACJO,QAAAA,MAAM,EAAE;AACJC,UAAAA,KAAK,EAAEhB,GAAG,CAAC,kCAAD,CADN;AAEJU,UAAAA,EAAE,EAAE;AAAEO,YAAAA,SAAS,EAAE;AAAb;AAFA;AADJ;AAFL,KAzCH;AAkDJgB,IAAAA,QAAQ,EAAE;AACN1B,MAAAA,OAAO,EAAE,QADH;AAENC,MAAAA,MAAM,EAAE;AACJO,QAAAA,MAAM,EAAE;AACJC,UAAAA,KAAK,EAAEhB,GAAG,CAAC,mCAAD,CADN;AAEJU,UAAAA,EAAE,EAAE;AACAO,YAAAA,SAAS,EAAE;AADX;AAFA;AADJ;AAFF;AAlDN;AAFwD,CAA7D","sourcesContent":["import { MachineConfig, send, Action } from \"xstate\";\nimport { nluRequest } from \"./index\"\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            initial: \"prompt\",\n            on: {\n                RECOGNISED: {\n                    target: \"invoking_rasa\",\n                }\n            },\n            states: {\n                prompt: {\n                    entry: say(\"Welcome! I can help you schedule a meeting, set an alarm and add to your to do list. What would you like to do?\"),\n                    on: { ENDSPEECH: \"ask\" }\n                },\n                ask: {\n                    entry: listen()\n                }\n            }\n        },\n        invoking_rasa: {\n            invoke: {\n                id: 'rasa',\n                src: (context, event) => nluRequest(context.recResult),\n                onDone: [\n                    { target: \"appointment\", cond: (context, event) => event.data.intent[\"name\"] === \"appointments\" },\n                    { target: \"timer\", cond: (context, event) => event.data.intent[\"name\"] === \"timer\" },\n                    { target: \"todoList\", cond: (context, event) => event.data.intent[\"name\"] === \"todo_item\" }],\n                onError: {\n                    target: 'welcome',\n                }\n            }\n\n\n        },\n        appointment: {\n            ...dmMachine\n        },\n        timer: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"OK. I will help you set a timer.\"),\n                    on: { ENDSPEECH: \"#root.dm\" }\n                }\n            }\n        },\n        todoList: {\n            initial: \"prompt\",\n            states: {\n                prompt: {\n                    entry: say(\"OK. Let's add to your to do list!\"),\n                    on: {\n                        ENDSPEECH: \"#root.dm\"\n                    }\n                },\n            }\n        }\n    }\n})"]},"metadata":{},"sourceType":"module"}