{"ast":null,"code":"import { send } from \"xstate\";\nimport { nluRequest } from \"./index\";\n\nfunction say(text) {\n  return send(function (_context) {\n    return {\n      type: \"SPEAK\",\n      value: text\n    };\n  });\n}\n\nfunction listen() {\n  return send('LISTEN');\n}\n\nexport var dmMachine = {\n  initial: 'init',\n  states: {\n    init: {\n      on: {\n        CLICK: 'welcome'\n      }\n    },\n    welcome: {\n      initial: \"prompt\",\n      on: {\n        RECOGNISED: {\n          target: \"invoking_rasa\"\n        }\n      },\n      states: {\n        prompt: {\n          entry: say(\"Welcome to MLT Maze Game! This is a dialogue-based game where you will try to reach your goal by choosing different routes. When you’re ready, say: Play.\"),\n          on: {\n            ENDSPEECH: \"ask\"\n          }\n        },\n        ask: {\n          entry: listen()\n        }\n      }\n    },\n    invoking_rasa: {\n      invoke: {\n        id: 'rasa',\n        src: function src(context, event) {\n          return nluRequest(context.recResult);\n        },\n        onDone: [{\n          target: \"game\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"play\";\n          }\n        }, {\n          target: \"help\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"help\";\n          }\n        }, {\n          target: \"quit\",\n          cond: function cond(context, event) {\n            return event.data.intent[\"name\"] === \"quiz\";\n          }\n        }],\n        onError: {\n          target: 'help'\n        }\n      }\n    },\n    game: {\n      initial: \"start\",\n      states: {\n        start: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \"humanisten\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"Ok, let’s play! It’s a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. You were the last one to turn in the exam and your classmates are already celebrating in a bar on Andra Långgatan. You need to get there before they finish their drinks and go home. But since you are new in the city, you are not sure of the way\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            }\n          }\n        },\n        humanisten: {\n          initial: \"prompt\",\n          on: {\n            RECOGNISED: {\n              target: \"gotaplatsen\"\n            }\n          },\n          states: {\n            prompt: {\n              entry: say(\"Ok, let’s play! It’s a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. You were the last one to turn in the exam and your classmates are already celebrating in a bar on Andra Långgatan. You need to get there before they finish their drinks and go home. But since you are new in the city, you are not sure of the way\"),\n              on: {\n                ENDSPEECH: \"ask\"\n              }\n            },\n            ask: {\n              entry: listen()\n            }\n          }\n        },\n        gotaplatsen: {},\n        korsvagen: {},\n        brunnsparken: {},\n        valand: {},\n        vasaplatsen: {},\n        jarntorget: {},\n        andralang: {},\n        kortedala: {},\n        hjalmarbranting: {},\n        styrostall: {},\n        win: {},\n        gameover: {}\n      }\n    },\n    help: {},\n    quit: {}\n  }\n};","map":{"version":3,"sources":["/mnt/c/Users/batst/LWshare/dialogue-systems-2021/course-project-klara-bastedt/src/dmGame.ts"],"names":["send","nluRequest","say","text","_context","type","value","listen","dmMachine","initial","states","init","on","CLICK","welcome","RECOGNISED","target","prompt","entry","ENDSPEECH","ask","invoking_rasa","invoke","id","src","context","event","recResult","onDone","cond","data","intent","onError","game","start","humanisten","gotaplatsen","korsvagen","brunnsparken","valand","vasaplatsen","jarntorget","andralang","kortedala","hjalmarbranting","styrostall","win","gameover","help","quit"],"mappings":"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","sourcesContent":["import { MachineConfig, send, Action } from \"xstate\";\nimport { nluRequest } from \"./index\"\n\nfunction say(text: string): Action<SDSContext, SDSEvent> {\n    return send((_context: SDSContext) => ({ type: \"SPEAK\", value: text }))\n}\n\nfunction listen(): Action<SDSContext, SDSEvent> {\n    return send('LISTEN')\n}\n\nexport const dmMachine: MachineConfig<SDSContext, any, SDSEvent> = ({\n    initial: 'init',\n    states: {\n        init: {\n            on: {\n                CLICK: 'welcome'\n            }\n        },\n        welcome: {\n            initial: \"prompt\",\n            on: {\n                RECOGNISED: {\n                    target: \"invoking_rasa\",\n                }\n            },\n            states: {\n                prompt: {\n                    entry: say(\"Welcome to MLT Maze Game! This is a dialogue-based game where you will try to reach your goal by choosing different routes. When you’re ready, say: Play.\"),\n                    on: { ENDSPEECH: \"ask\" }\n                },\n                ask: {\n                    entry: listen()\n                }\n            }\n        },\n        invoking_rasa: {\n            invoke: {\n                id: 'rasa',\n                src: (context, event) => nluRequest(context.recResult),\n                onDone: [\n                    { target: \"game\", cond: (context, event) => event.data.intent[\"name\"] === \"play\" },\n                    { target: \"help\", cond: (context, event) => event.data.intent[\"name\"] === \"help\" },\n                    { target: \"quit\", cond: (context, event) => event.data.intent[\"name\"] === \"quiz\" }],\n                onError: {\n                    target: 'help',\n                }\n            }\n\n\n        },\n        game: {\n            initial: \"start\",\n            states: {\n                start: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \"humanisten\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"Ok, let’s play! It’s a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. You were the last one to turn in the exam and your classmates are already celebrating in a bar on Andra Långgatan. You need to get there before they finish their drinks and go home. But since you are new in the city, you are not sure of the way\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        }\n                    }\n                },\n                humanisten: {\n                    initial: \"prompt\",\n                    on: {\n                        RECOGNISED: {\n                            target: \"gotaplatsen\",\n                        }\n                    },\n                    states: {\n                        prompt: {\n                            entry: say(\"Ok, let’s play! It’s a beautiful day in spring. You are an MLT student and have just finished an exam at Humanisten. You were the last one to turn in the exam and your classmates are already celebrating in a bar on Andra Långgatan. You need to get there before they finish their drinks and go home. But since you are new in the city, you are not sure of the way\"),\n                            on: { ENDSPEECH: \"ask\" }\n                        },\n                        ask: {\n                            entry: listen()\n                        }\n                    }\n                },\n                gotaplatsen: {},\n                korsvagen: {},\n                brunnsparken: {},\n                valand: {},\n                vasaplatsen: {},\n                jarntorget: {},\n                andralang: {},\n                kortedala: {},\n                hjalmarbranting: {},\n                styrostall: {},\n                win: {},\n                gameover: {},\n            }\n        },\n        help: {},\n        quit: {}\n    }\n})"]},"metadata":{},"sourceType":"module"}